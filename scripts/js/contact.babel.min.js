"use strict";function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}var isFunction=function(e){return _instanceof(e,Function)},isDOMElement=function(e){return _instanceof(e,Element)},isHTMLElement=function(e){return _instanceof(e,HTMLElement)},Mailbox=function(){function e(t){var r=t.id,n=void 0===r?"form_1":r,i=t.form,o=void 0===i?"form":i,a=t.carrier,s=t.destination,c=t.recaptcha,u=t.progress,l=t.success,f=t.failure;if(_classCallCheck(this,e),this.form=o,this.id=n,this.carrier=a,this.destination=s,this.recaptcha=c,this.progress=u,this.failure=f,this.success=l,!document.querySelector(this.form))return null;if(this.form=document.querySelector(this.form),!isHTMLElement(this.form))throw new TypeError("\n                Expected a valid DOM node for the <form> element:\n                incorrect identifier or missing <form> element.\n            ");this.form.querySelector("[required]")&&(this.requiredFields=this.form.querySelectorAll("[required]")),this.recaptcha&&this.addSpamService(),this.form.addEventListener("submit",this.send.bind(this))}return _createClass(e,[{key:"addSpamService",value:function(){var e=document.querySelector("head"),t=document.createElement("script");t.setAttribute("async",""),t.setAttribute("src","".concat("https://www.google.com/recaptcha/api.js?render=").concat(this.recaptcha)),e.append(t)}},{key:"runSpamFilter",value:function(){var e=this;return this.recaptcha?new Promise((function(t){grecaptcha.ready((function(){grecaptcha.execute(e.recaptcha,{action:e.id}).then((function(e){t(e)}))}))})):null}},{key:"validate",value:function(){if(this.requiredFields){var e,t=_createForOfIteratorHelper(this.requiredFields);try{for(t.s();!(e=t.n()).done;){if(!1===e.value.checkValidity())return null}}catch(e){t.e(e)}finally{t.f()}}}},{key:"busy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};isFunction(this.progress)?this.progress(e):console.info("Sending the message...")}},{key:"done",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"failure"===e?this.failure?isFunction(this.failure)?this.failure(t):window.location.replace(this.failure):console.error(t.description):this.success?isFunction(this.success)?this.success(t):window.location.replace(this.success):void console.info("Success: message delivered.")}},{key:"xhr",value:function(t){var r=this,n=new XMLHttpRequest;n.open(e.method,this.destination),n.timeout=5e3,n.send(t),n.onprogress=this.busy,n.onload=function(){n.status>=200&&n.status<300?r.done("success",n):console.error(r.xhrError)},n.onerror=function(){return console.error(r.xhrError)}}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){var r=this,n=fetch(this.destination,{body:t,method:e.method});this.busy(n),n.then((function(e){if(!e.ok)throw new Error("HTTP error: ".concat(n.status));return e.json()})).then((function(e){0===e.responseCode?r.done("success",e):r.done("failure",e)}))}))},{key:"send",value:function(e){var t=this;e.preventDefault(),this.validate(),this.runSpamFilter().then((function(e){var r=new FormData(t.form);return r.append("token",e),r.append("id",t.id),r})).then((function(e){"xhr"===t.carrier?t.xhr(e):t.fetch(e)})).catch((function(e){return console.error("Error:",e)}))}},{key:"xhrError",get:function(){return"Error sending message: ".concat(request.response,"\n                Status: ").concat(request.statusText)}}]),e}();_defineProperty(Mailbox,"method","POST"),document.addEventListener("DOMContentLoaded",(function(){var e=$("form"),t=$("form").html();new Mailbox({id:"jamaka_1",destination:"https://forms.cygnul.com/",recaptcha:"6LfiaNoZAAAAALtFL8I8M_joMoppfEG_Hb0HRX9x",busy:function(){$(":submit").attr("disabled",!0).val("Sending Message...");var e=$("form"),t=new Image;t.src="../images/contact/load.gif";var r='<img src="'+t.src+'" width="54" height="55">';e.children().fadeOut(800),e.prepend(r)},success:function(r){var n=$('<div id="sent">                                                                               <h1><span>&#10004;</span> Message received.</h1>                                                                               <h2>Thank you.</h2>                                                                               <hr>                                                                               <p>We will respond soon.</p>                                                                          </div>');e.html(n.fadeIn("slow",(function(){var r=$(this);r.delay(5e3).fadeOut(1e3,(function(){e.html(t).hide().fadeIn(1e3),r.find(":submit").attr("disabled",!1).val("Send Message")}))})))},failure:function(){var t=$('<p id="error">Error sending mail, please retry.</p>');e.before(t.slideDown(400,(function(){$(this).delay(3e3).slideUp(500,(function(){$(this).remove()}))})))}})}));
